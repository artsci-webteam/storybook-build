import{n as f,g as O,h as z,F as B,i as G,k as V}from"./index-9901d106.js";import{r as g,R as p}from"./index-a1a61b1e.js";import{t as M,Z as F,H as T,u as W,c as u}from"./throttle-46fd1a8f.js";import"./iframe-e4550089.js";import"../sb-preview/runtime.js";import"./index-1b441bc2.js";import"./doctrine-144bae0b.js";import"./index-356e4a49.js";var N=f.div({position:"relative",maxWidth:250,'&[aria-readonly="true"]':{opacity:.5}}),A=f(O)({position:"absolute",zIndex:1,top:4,left:4,"[aria-readonly=true] &":{cursor:"not-allowed"}}),j=f.div({width:200,margin:5,".react-colorful__saturation":{borderRadius:"4px 4px 0 0"},".react-colorful__hue":{boxShadow:"inset 0 0 0 1px rgb(0 0 0 / 5%)"},".react-colorful__last-control":{borderRadius:"0 0 4px 4px"}}),Z=f(z)(({theme:e})=>({fontFamily:e.typography.fonts.base})),q=f.div({display:"grid",gridTemplateColumns:"repeat(9, 16px)",gap:6,padding:3,marginTop:5,width:200}),D=f.div(({theme:e,active:t})=>({width:16,height:16,boxShadow:t?`${e.appBorderColor} 0 0 0 1px inset, ${e.textMutedColor}50 0 0 0 4px`:`${e.appBorderColor} 0 0 0 1px inset`,borderRadius:e.appBorderRadius})),J=`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,R=({value:e,style:t,...r})=>{let i=`linear-gradient(${e}, ${e}), ${J}, linear-gradient(#fff, #fff)`;return p.createElement(D,{...r,style:{...t,backgroundImage:i}})},K=f(B.Input)(({theme:e,readOnly:t})=>({width:"100%",paddingLeft:30,paddingRight:30,boxSizing:"border-box",fontFamily:e.typography.fonts.base})),Q=f(G)(({theme:e})=>({position:"absolute",zIndex:1,top:6,right:7,width:20,height:20,padding:4,boxSizing:"border-box",cursor:"pointer",color:e.input.color})),P=(e=>(e.RGB="rgb",e.HSL="hsl",e.HEX="hex",e))(P||{}),w=Object.values(P),U=/\(([0-9]+),\s*([0-9]+)%?,\s*([0-9]+)%?,?\s*([0-9.]+)?\)/,Y=/^\s*rgba?\(([0-9]+),\s*([0-9]+),\s*([0-9]+),?\s*([0-9.]+)?\)\s*$/i,ee=/^\s*hsla?\(([0-9]+),\s*([0-9]+)%,\s*([0-9]+)%,?\s*([0-9.]+)?\)\s*$/i,C=/^\s*#?([0-9a-f]{3}|[0-9a-f]{6})\s*$/i,te=/^\s*#?([0-9a-f]{3})\s*$/i,ae={hex:F,rgb:T,hsl:W},y={hex:"transparent",rgb:"rgba(0, 0, 0, 0)",hsl:"hsla(0, 0%, 0%, 0)"},_=e=>{let t=e==null?void 0:e.match(U);if(!t)return[0,0,0,1];let[,r,i,l,o=1]=t;return[r,i,l,o].map(Number)},$=e=>{if(!e)return;let t=!0;if(Y.test(e)){let[n,a,h,x]=_(e),[b,d,s]=u.rgb.hsl([n,a,h])||[0,0,0];return{valid:t,value:e,keyword:u.rgb.keyword([n,a,h]),colorSpace:"rgb",rgb:e,hsl:`hsla(${b}, ${d}%, ${s}%, ${x})`,hex:`#${u.rgb.hex([n,a,h]).toLowerCase()}`}}if(ee.test(e)){let[n,a,h,x]=_(e),[b,d,s]=u.hsl.rgb([n,a,h])||[0,0,0];return{valid:t,value:e,keyword:u.hsl.keyword([n,a,h]),colorSpace:"hsl",rgb:`rgba(${b}, ${d}, ${s}, ${x})`,hsl:e,hex:`#${u.hsl.hex([n,a,h]).toLowerCase()}`}}let r=e.replace("#",""),i=u.keyword.rgb(r)||u.hex.rgb(r),l=u.rgb.hsl(i),o=e;if(/[^#a-f0-9]/i.test(e)?o=r:C.test(e)&&(o=`#${r}`),o.startsWith("#"))t=C.test(o);else try{u.keyword.hex(o)}catch{t=!1}return{valid:t,value:o,keyword:u.rgb.keyword(i),colorSpace:"hex",rgb:`rgba(${i[0]}, ${i[1]}, ${i[2]}, 1)`,hsl:`hsla(${l[0]}, ${l[1]}%, ${l[2]}%, 1)`,hex:o}},re=(e,t,r)=>{if(!e||!(t!=null&&t.valid))return y[r];if(r!=="hex")return(t==null?void 0:t[r])||y[r];if(!t.hex.startsWith("#"))try{return`#${u.keyword.hex(t.hex)}`}catch{return y.hex}let i=t.hex.match(te);if(!i)return C.test(t.hex)?t.hex:y.hex;let[l,o,n]=i[1].split("");return`#${l}${l}${o}${o}${n}${n}`},le=(e,t)=>{let[r,i]=g.useState(e||""),[l,o]=g.useState(()=>$(r)),[n,a]=g.useState((l==null?void 0:l.colorSpace)||"hex");g.useEffect(()=>{let d=e||"",s=$(d);i(d),o(s),a((s==null?void 0:s.colorSpace)||"hex")},[e]);let h=g.useMemo(()=>re(r,l,n).toLowerCase(),[r,l,n]),x=g.useCallback(d=>{let s=$(d),m=(s==null?void 0:s.value)||d||"";i(m),m===""&&(o(void 0),t(void 0)),s&&(o(s),a(s.colorSpace),t(s.value))},[t]),b=g.useCallback(()=>{let d=w.indexOf(n)+1;d>=w.length&&(d=0),a(w[d]);let s=(l==null?void 0:l[w[d]])||"";i(s),t(s)},[l,n,t]);return{value:r,realValue:h,updateValue:x,color:l,colorSpace:n,cycleColorSpace:b}},E=e=>e.replace(/\s*/,"").toLowerCase(),se=(e,t,r)=>{let[i,l]=g.useState(t!=null&&t.valid?[t]:[]);g.useEffect(()=>{t===void 0&&l([])},[t]);let o=g.useMemo(()=>(e||[]).map(a=>typeof a=="string"?$(a):a.title?{...$(a.color),keyword:a.title}:$(a.color)).concat(i).filter(Boolean).slice(-27),[e,i]),n=g.useCallback(a=>{a!=null&&a.valid&&(o.some(h=>E(h[r])===E(a[r]))||l(h=>h.concat(a)))},[r,o]);return{presets:o,addPreset:n}},oe=({name:e,value:t,onChange:r,onFocus:i,onBlur:l,presetColors:o,startOpen:n=!1,argType:a})=>{var v;let h=g.useCallback(M(r,200),[r]),{value:x,realValue:b,updateValue:d,color:s,colorSpace:m,cycleColorSpace:H}=le(t,h),{presets:S,addPreset:I}=se(o,s,m),L=ae[m],k=!!((v=a==null?void 0:a.table)!=null&&v.readonly);return p.createElement(N,{"aria-readonly":k},p.createElement(A,{startOpen:n,trigger:k?[null]:void 0,closeOnOutsideClick:!0,onVisibleChange:()=>I(s),tooltip:p.createElement(j,null,p.createElement(L,{color:b==="transparent"?"#000000":b,onChange:d,onFocus:i,onBlur:l}),S.length>0&&p.createElement(q,null,S.map((c,X)=>p.createElement(O,{key:`${c.value}-${X}`,hasChrome:!1,tooltip:p.createElement(Z,{note:c.keyword||c.value})},p.createElement(R,{value:c[m],active:s&&E(c[m])===E(s[m]),onClick:()=>d(c.value)})))))},p.createElement(R,{value:b,style:{margin:4}})),p.createElement(K,{id:V(e),value:x,onChange:c=>d(c.target.value),onFocus:c=>c.target.select(),readOnly:k,placeholder:"Choose color..."}),x?p.createElement(Q,{onClick:H}):null)},be=oe;export{oe as ColorControl,be as default};
